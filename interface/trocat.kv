#:include first_file.kv
# --
<TelaInicial>:
    BoxLayout:
        orientation: 'vertical'
        Image:
            source: 'data/logoTroCat.png'

        BoxLayout:
            orientation: 'horizontal'
            size_hint: 1, None
            height: 50
            spacing: 15
            AnchorLayout:
                anchor_x: 'right'
                anchor_y: 'center'
                ButtonFont:
                    text: 'Login'
                    size_hint: None, 1
                    width: 120
                    on_release: root.IrParaLogin()
            AnchorLayout:
                anchor_x: 'left'
                anchor_y: 'center'

                ButtonFont:
                    text: 'Cadastrar'
                    size_hint: None, 1
                    width: 120
                    on_release: root.IrParaCadastroUsuario()
        Label:
            text: ''
            size_hint: 1, None
            height: 5
        ButtonFont:
            text: 'Créditos'
            size_hint: None, None
            width: 120
            height: 50
            pos_hint: {'x': 0.42}
            on_release: Factory.PopupCreditos().open()
        Label:
            text: ''
            size_hint: 1, None
            height: 100
        ButtonFont:
            text: '?'
            size_hint: 0.05, 0.1
            on_release: Factory.PopupInterrogacao().open()

# --
<Login>:
    BoxLayout:
        orientation: 'vertical'
        padding: 50
        spacing: 20
        LabelLogin:
            id: Jovem
            text: 'Login'
            color: 0,0,0,1
            bold: 1
            font_size: 45
            size_hint: 1, None  

        BoxLayout:
            orientation: 'horizontal'

            LabelLogin:
                text: 'Email'
                color: 0,0,0,1
                bold: 1
                font_size: 20
                size_hint: (0.4, 0.2)
                pos_hint: {'center_x': 0.5}
            Label:
                text: ''
                size_hint: 0.1, 0
            LabelLogin:
                text: 'Senha'
                color: 0,0,0,1
                bold: 1
                font_size: 20
                size_hint: (0.4, 0.2)
                pos_hint: {'center_x': 0.5}

        BoxLayout:
            orientation: 'horizontal'

            TextInput:
                id: OK
                multiline: False
                size_hint: 1, 0.3
                write_tab: False
            Label:
                text: ''
                size_hint: 0.1, 0
            TextInput:
                id: not_OK
                multiline: False
                size_hint: 1, 0.3
                write_tab: False
                password: True
        ButtonFont:
            id: loucura
            text: 'Entrar'
            on_press: root.Clicou()
            pos_hint: {'center_x': 0.5}
            size_hint: (0.3, 0.5)
# --
<TelaCadastroUsuario>:
    BoxLayout:
        padding: 50
        spacing: 10
        orientation: 'vertical'

        LabelCadastro:
            id: cad
            text: 'Cadastrar Usuário'
            font_size: 40
            color: 0,0,0,1
            bold: 1
            size_hint: 1, 0.5

        GridLayout:
            cols: 2
            padding: 10
            spacing: 10

            LabelCadastro:
                text: 'Nome:'
                color: 0,0,0,1
                bold: 1
            InputCadastro:
                id: nome

            LabelCadastro:
                text: 'E-mail:'
                color: 0,0,0,1
                bold: 1
            InputCadastro:
                id: email

            LabelCadastro:
                text: 'Senha:'
                color: 0,0,0,1
                bold: 1
            InputCadastro:
                id: senha
        GridLayout:
            cols: 2
            padding: 70
            
            ButtonFont:
                text: 'Voltar'
                pos_hint: {'center_x': 0.5}
                size_hint: (0.5, 0.5)
                on_press: root.IrParaTelaInicial()

            ButtonFont:
                text: 'Cadastrar'
                background_color: 1, 1, 0, 1
                pos_hint: {'center_x': 0.5}
                size_hint: (0.5, 0.5)
                on_press: root.CadastrarUsuario()    


<TelaMenu>:
    BoxLayout:
        orientation: 'vertical'
        padding: 15
        LabelFont:
            text: 'Menu'
            font_size: 45
            bold: 1
            color: 0,0,0,1

        GridLayout:
            cols: 2

            ButtonFont:
                text: 'Vouchers'
                bold: 1
                font_size: 20
                on_press: root.IrParaVouchers()
            ButtonFont:
                text: 'Cadastrar Voucher'
                bold: 1
                font_size: 20
                on_press: root.IrParaCadastro()
            ButtonFont:
                text: 'Meus Vouchers'
                bold: 1
                font_size: 20
                on_press: root.IrParaMeusVouchers()
            ButtonFont:
                text: 'Solicitações de Trocas Recebidas'
                bold: 1
                font_size: 20
                on_press: root.IrParaTrocas()
        ButtonFont:
            text: 'Deslogar'
            on_press: root.Deslogar()

# --
<TelaCadastro>:
    BoxLayout:
        padding: 50
        spacing: 10
        orientation: 'vertical'

        LabelCadastro:
            id: cad
            text: 'Cadastrar Voucher'
            font_size: 40
            color: 0,0,0,1
            bold: 1
            size_hint: 1, 0.5

        GridLayout:
            cols: 2
            padding: 10
            spacing: 10

            LabelCadastro:
                text: 'Título:'
                color: 0,0,0,1
                bold: 1
            InputCadastro:
                id: titulo

            LabelCadastro:
                text: 'Descrição:'
                color: 0,0,0,1
                bold: 1
            InputCadastro:
                id: descricao

            LabelCadastro:
                text: 'Gato:'
                color: 0,0,0,1
                bold: 1
            InputCadastro:
                id: gato

            LabelCadastro:
                text: 'Local:'
                color: 0,0,0,1
                bold: 1
            InputCadastro:
                id: local

            LabelCadastro:
                text: 'Lanche:'
                color: 0,0,0,1
                bold: 1
            InputCadastro:
                id: lanche

            LabelCadastro:
                text: 'Duração:'
                color: 0,0,0,1
                bold: 1
            InputCadastro:
                id: duracao

        GridLayout:
            cols: 2
            size_hint: 1, None
            height: 100
            padding: 30
            
            ButtonFont:
                text: 'Voltar'
                pos_hint: {'center_x': 0.5}
                size_hint: (0.5, 0.5)
                on_press: root.IrParaMenu()

            ButtonFont:
                text: 'Cadastrar'
                background_color: 1, 1, 0, 1
                pos_hint: {'center_x': 0.5}
                size_hint: (0.5, 0.5)
                on_press: root.CadastrarVoucher()

<Voucher>:
    canvas.before:
        Color:
            rgba: (.0, 0.9, .1, .3) if self.selected else (253/255, 228/255, 71/255, 1)
        Rectangle:
            pos: self.pos
            size: self.size
        Color:
            rgba: 0, 0, 0, 1
        Line:
            width: 2
            rectangle: self.x, self.y, self.width, self.height
        
    orientation: 'vertical'
    BoxLayout:
        orientation: 'horizontal'
        Image:
            source: root.imagem
            size: self.texture_size
            #allow_stretch: True
            #keep_ratio: False
            size_hint: 1, 1
            #height: 200
            #width: 50
        BoxLayout:
            orientation: 'vertical'

            LabelCadastro:
                text: root.label_titulo
            LabelCadastro:
                text: root.label_descricao
            LabelCadastro:
                text: root.label_nome_gato
            LabelCadastro:
                text: root.label_local
            LabelCadastro:
                text: root.label_lanche
            LabelCadastro:
                text: root.label_duracao
# --
<VoucherII>:
    canvas.before:
        Color:
            rgba: (253/255, 228/255, 71/255, 1)
        Rectangle:
            pos: self.pos
            size: self.size
    orientation: 'horizontal'
    Image:
        source: root.imagem
        #size: self.texture_size
        allow_stretch: True
        keep_ratio: False
    BoxLayout:
        orientation: 'vertical'

        LabelCadastro:
            text: root.label_titulo
        LabelCadastro:
            text: root.label_descricao
        LabelCadastro:
            text: root.label_nome_gato
        LabelCadastro:
            text: root.label_local
        LabelCadastro:
            text: root.label_lanche
        LabelCadastro:
            text: root.label_duracao
# --
<TelaMeusVouchers>:
    on_enter: terra.LoadDataUser()
    BoxLayout:
        orientation: 'vertical'
        #padding: 50
        #spacing: 20
        LabelLogin:
            text: 'Meus Vouchers'
            color: 0,0,0,1
            bold: 1
            font_size: 45
            size_hint: 1, None
            height: 50
        ButtonFont:
            text: 'Retornar menu'
            on_press: root.IrParaMenu()
            size_hint: 1, None
            height: 50
        RV:
            id: terra
            viewclass: 'VoucherII'  # defines the viewtype for the data items.
            orientation: "horizontal"
            data: self.rv_data_list
            RecycleGridLayout:
                cols: 3
                spacing: 10
                size_hint: 1, 1
                default_size: None, dp(112)
                default_size_hint: 1, None
                height: self.minimum_height
                width: self.minimum_width
# --   
<PopupTroca@Popup>:
    auto_dismiss: False
    title: 'Troca'
    on_open: jovial.LoadDataUser()
    BoxLayout:
        orientation: 'vertical'
        Label:
            text: 'Selecione um voucher seu para propor a troca'
            size_hint: 1, None
            height: 50
        Button:
            text: 'Voltar'
            on_release: root.dismiss()
            size_hint: 1, None
            height: 50
        RV:
            id: jovial
            viewclass: 'Voucher'  # defines the viewtype for the data items.
            orientation: "horizontal"
            data: self.rv_data_list
            space_x: self.size[0]/3
            SelectableRecycleGridLayout:
                cols: 3
                spacing: 10
                size_hint: 1, None
                default_size: None, dp(160)
                default_size_hint: 1, None
                height: self.minimum_height
                width: self.minimum_width
        ButtonFont:
            text: 'Propor Troca'
            size_hint: 1, None
            height: 50
            on_release:
                if jovial.IsAnyVoucherSelected(): root.dismiss(); jovial.AddVoucherSelected(), jovial.GetPropostaTroca(); root.parent.current = 'telamenu'


<TelaVouchers>:
    on_enter: joia.LoadData(), joia.PrintTes()
    BoxLayout:
        orientation: 'vertical'
        #padding: 50
        #spacing: 20
        LabelLogin:
            text: 'Vouchers'
            color: 0,0,0,1
            bold: 1
            font_size: 45
            size_hint: 1, None
            height: 50
        Button:
            text: 'Retornar menu'
            size_hint: 1, None
            height: 50
            on_press: root.IrParaMenu()
        RV:
            id: joia
            viewclass: 'Voucher'  # defines the viewtype for the data items.
            orientation: "horizontal"
            data: self.rv_data_list
            #spacing: 80
            #padding:50, 50
            space_x: self.size[0]/3
            SelectableRecycleGridLayout:
                cols: 2
                spacing: 10
                padding: 5
                size_hint: 1, None
                default_size: None, dp(160)
                default_size_hint: 1, None
                height: self.minimum_height
                width: self.minimum_width
        Button:
            text: 'Propor Troca'
            #on_press: root.IrParaMenu()
            size_hint: 1, None
            height: 50
            on_release: 
                if joia.IsAnyVoucherSelected(): Factory.PopupTroca().open(); joia.AddVoucherSelected()
                #print(joia.IsAnyVoucherSelected()) 

<ComponenteTroca>:
    canvas.before:
        Color:
            rgba: (.0, 0.9, .1, .3)
    orientation: 'vertical'
    LabelCadastro:
        text: root.label_titulo
        color: 0,0,0,1
        bold: 1
    BoxLayout:
        orientation: 'horizontal'
        BoxLayout:
            orientation: 'vertical'
            Label:
                text: root.label_trocaI_titulo
                color: 0,0,0,1
            Label:
                text: root.label_trocaI_gato
                color: 0,0,0,1

        BoxLayout:
            orientation: 'vertical'
            Label:
                text: root.label_trocaII_titulo
                color: 0,0,0,1

            Label:
                text: root.label_trocaII_gato
                color: 0,0,0,1

    BoxLayout:
        orientation: 'horizontal'
        Button:
            text: 'Aceitar'
            on_release: root.aceitarClick()
        Button:
            text: 'Negar'
            on_release: root.rejeitarClick()

<TelaTrocas>:
    on_enter: compTroca.InicializarTrocas()
    BoxLayout:
        orientation: 'vertical'
        #padding: 50
        #spacing: 20
        LabelLogin:
            text: 'Trocas Pendentes'
            color: 0,0,0,1
            bold: 1
            font_size: 45
            size_hint: 1, None
            height: 50
        RV:
            id: compTroca
            viewclass: 'ComponenteTroca'  # defines the viewtype for the data items.
            orientation: "horizontal"
            data: self.rv_data_list
            #spacing: 80
            #padding:50, 50
            space_x: self.size[0]/3
            SelectableRecycleGridLayout:
                cols: 2
                spacing: 10
                size_hint: 1, None
                default_size: None, dp(112)
                default_size_hint: 1, None
                height: self.minimum_height
                width: self.minimum_width
        Button:
            text: 'Retornar menu'
            size_hint: 1, None
            height: 50
            on_press:  root.IrParaMenu()